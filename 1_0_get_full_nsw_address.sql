\COPY (SELECT DISTINCT address_detail.address_detail_pid, flat_type_aut.code AS flat_type_code, flat_type_aut.name AS flat_type_name, CASE WHEN address_detail.flat_number_prefix IS NULL AND address_detail.flat_number IS NULL AND address_detail.flat_number_suffix IS NULL THEN NULL ELSE CONCAT_WS('', address_detail.flat_number_prefix, address_detail.flat_number, address_detail.flat_number_suffix) END AS flat_number, level_type_aut.code AS level_type_code, level_type_aut.name AS level_type_name, CASE WHEN address_detail.level_number_prefix IS NULL AND address_detail.level_number IS NULL AND address_detail.level_number_suffix IS NULL THEN NULL ELSE CONCAT_WS('', address_detail.level_number_prefix, address_detail.level_number, address_detail.level_number_suffix) END AS level_number, CONCAT_WS('-', CASE WHEN address_detail.number_first_prefix IS NULL AND address_detail.number_first IS NULL AND address_detail.number_first_suffix IS NULL THEN NULL ELSE CONCAT_WS('', address_detail.number_first_prefix, address_detail.number_first, address_detail.number_first_suffix) END, CASE WHEN address_detail.number_last_prefix IS NULL AND address_detail.number_last IS NULL AND address_detail.number_last_suffix IS NULL THEN NULL ELSE CONCAT_WS('', address_detail.number_last_prefix, address_detail.number_last, address_detail.number_last_suffix) END) as street_number, street_locality.street_name, street_type_aut.name AS street_type_code, street_type_aut.code AS street_type_name, street_suffix_aut.code AS street_suffix_code, street_suffix_aut.name AS street_suffix_name, locality.locality_name, state.state_abbreviation AS state_code, state.state_name AS state_name, address_detail.postcode, 'AUSTRALIA' AS country FROM address_detail LEFT JOIN street_locality ON street_locality.street_locality_pid = address_detail.street_locality_pid LEFT JOIN locality ON locality.locality_pid = address_detail.locality_pid LEFT JOIN level_type_aut ON level_type_aut.code = address_detail.level_type_code LEFT JOIN flat_type_aut ON flat_type_aut.code = address_detail.flat_type_code LEFT JOIN street_suffix_aut ON street_suffix_aut.code = street_locality.street_suffix_code LEFT JOIN street_type_aut ON street_type_aut.code = street_locality.street_type_code LEFT JOIN state ON state.state_pid = locality.state_pid) TO 'address_fields.csv' DELIMITER ',' CSV HEADER;